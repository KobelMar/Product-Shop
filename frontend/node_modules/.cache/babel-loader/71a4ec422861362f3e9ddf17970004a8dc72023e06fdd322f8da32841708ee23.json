{"ast":null,"code":"import _objectSpread from\"/Users/maxmar/repos/MERN/simple-mern-project/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/maxmar/repos/MERN/simple-mern-project/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/maxmar/repos/MERN/simple-mern-project/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/maxmar/repos/MERN/simple-mern-project/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import Header from\"./components/Header/Header\";import NewProduct from\"./components/Products/NewProduct\";import ProductList from\"./components/Products/ProductList\";import\"./App.css\";function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),loadedProducts=_useState2[0],setLoadedProducts=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];useEffect(function(){var fetchProducts=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,responseData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsLoading(true);_context.next=3;return fetch(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/products\"));case 3:response=_context.sent;_context.next=6;return response.json();case 6:responseData=_context.sent;setLoadedProducts(responseData.products);setIsLoading(false);case 9:case\"end\":return _context.stop();}}},_callee);}));return function fetchProducts(){return _ref.apply(this,arguments);};}();fetchProducts();},[]);var addProductHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(productName,productPrice){var newProduct,hasError,response,responseData;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;newProduct={title:productName,price:+productPrice// \"+\" to convert string to number\n};hasError=false;_context2.next=5;return fetch(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/product\"),{method:\"POST\",body:JSON.stringify(newProduct),headers:{\"Content-Type\":\"application/json\"}});case 5:response=_context2.sent;if(!response.ok){hasError=true;}_context2.next=9;return response.json();case 9:responseData=_context2.sent;if(!hasError){_context2.next=12;break;}throw new Error(responseData.message);case 12:setLoadedProducts(function(prevProducts){return prevProducts.concat(_objectSpread(_objectSpread({},newProduct),{},{id:responseData.product.id}));});_context2.next=18;break;case 15:_context2.prev=15;_context2.t0=_context2[\"catch\"](0);alert(_context2.t0.message||\"Something went wrong!\");case 18:case\"end\":return _context2.stop();}}},_callee2,null,[[0,15]]);}));return function addProductHandler(_x,_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(\"main\",null,/*#__PURE__*/React.createElement(NewProduct,{onAddProduct:addProductHandler}),isLoading&&/*#__PURE__*/React.createElement(\"p\",{className:\"loader\"},\"Loading...\"),!isLoading&&/*#__PURE__*/React.createElement(ProductList,{items:loadedProducts})));}export default App;","map":{"version":3,"names":["React","useState","useEffect","Header","NewProduct","ProductList","App","loadedProducts","setLoadedProducts","isLoading","setIsLoading","fetchProducts","fetch","process","env","REACT_APP_BACKEND_URL","response","json","responseData","products","addProductHandler","productName","productPrice","newProduct","title","price","hasError","method","body","JSON","stringify","headers","ok","Error","message","prevProducts","concat","id","product","alert"],"sources":["/Users/maxmar/repos/MERN/simple-mern-project/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\n\nimport Header from \"./components/Header/Header\";\nimport NewProduct from \"./components/Products/NewProduct\";\nimport ProductList from \"./components/Products/ProductList\";\nimport \"./App.css\";\n\nfunction App() {\n  const [loadedProducts, setLoadedProducts] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n\n  useEffect(() => {\n    const fetchProducts = async () => {\n      setIsLoading(true);\n      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/products`);\n\n      const responseData = await response.json();\n\n      setLoadedProducts(responseData.products);\n      setIsLoading(false);\n    };\n\n    fetchProducts();\n  }, []);\n\n  const addProductHandler = async (productName, productPrice) => {\n    try {\n      const newProduct = {\n        title: productName,\n        price: +productPrice, // \"+\" to convert string to number\n      };\n      let hasError = false;\n      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/product`, {\n        method: \"POST\",\n        body: JSON.stringify(newProduct),\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      });\n\n      if (!response.ok) {\n        hasError = true;\n      }\n\n      const responseData = await response.json();\n\n      if (hasError) {\n        throw new Error(responseData.message);\n      }\n\n      setLoadedProducts((prevProducts) => {\n        return prevProducts.concat({\n          ...newProduct,\n          id: responseData.product.id,\n        });\n      });\n    } catch (error) {\n      alert(error.message || \"Something went wrong!\");\n    }\n  };\n\n  return (\n    <React.Fragment>\n      <Header />\n      <main>\n        <NewProduct onAddProduct={addProductHandler} />\n        {isLoading && <p className=\"loader\">Loading...</p>}\n        {!isLoading && <ProductList items={loadedProducts} />}\n      </main>\n    </React.Fragment>\n  );\n}\n\nexport default App;\n"],"mappings":"2jBAAA,MAAOA,MAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAElD,MAAOC,OAAM,KAAM,4BAA4B,CAC/C,MAAOC,WAAU,KAAM,kCAAkC,CACzD,MAAOC,YAAW,KAAM,mCAAmC,CAC3D,MAAO,WAAW,CAElB,QAASC,IAAG,EAAG,CACb,cAA4CL,QAAQ,CAAC,EAAE,CAAC,wCAAjDM,cAAc,eAAEC,iBAAiB,eACxC,eAAkCP,QAAQ,CAAC,KAAK,CAAC,yCAA1CQ,SAAS,eAAEC,YAAY,eAE9BR,SAAS,CAAC,UAAM,CACd,GAAMS,cAAa,4FAAG,+JACpBD,YAAY,CAAC,IAAI,CAAC,CAAC,sBACIE,MAAK,WAAIC,OAAO,CAACC,GAAG,CAACC,qBAAqB,cAAY,QAAvEC,QAAQ,qCAEaA,SAAQ,CAACC,IAAI,EAAE,QAApCC,YAAY,eAElBV,iBAAiB,CAACU,YAAY,CAACC,QAAQ,CAAC,CACxCT,YAAY,CAAC,KAAK,CAAC,CAAC,sDACrB,kBARKC,cAAa,0CAQlB,CAEDA,aAAa,EAAE,CACjB,CAAC,CAAE,EAAE,CAAC,CAEN,GAAMS,kBAAiB,6FAAG,kBAAOC,WAAW,CAAEC,YAAY,uLAEhDC,UAAU,CAAG,CACjBC,KAAK,CAAEH,WAAW,CAClBI,KAAK,CAAE,CAACH,YAAc;AACxB,CAAC,CACGI,QAAQ,CAAG,KAAK,wBACGd,MAAK,WAAIC,OAAO,CAACC,GAAG,CAACC,qBAAqB,aAAY,CAC3EY,MAAM,CAAE,MAAM,CACdC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACP,UAAU,CAAC,CAChCQ,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,QANIf,QAAQ,gBAQd,GAAI,CAACA,QAAQ,CAACgB,EAAE,CAAE,CAChBN,QAAQ,CAAG,IAAI,CACjB,CAAC,uBAE0BV,SAAQ,CAACC,IAAI,EAAE,QAApCC,YAAY,oBAEdQ,QAAQ,gCACJ,IAAIO,MAAK,CAACf,YAAY,CAACgB,OAAO,CAAC,SAGvC1B,iBAAiB,CAAC,SAAC2B,YAAY,CAAK,CAClC,MAAOA,aAAY,CAACC,MAAM,gCACrBb,UAAU,MACbc,EAAE,CAAEnB,YAAY,CAACoB,OAAO,CAACD,EAAE,GAC3B,CACJ,CAAC,CAAC,CAAC,qFAEHE,KAAK,CAAC,aAAML,OAAO,EAAI,uBAAuB,CAAC,CAAC,uEAEnD,kBAlCKd,kBAAiB,iDAkCtB,CAED,mBACE,oBAAC,KAAK,CAAC,QAAQ,mBACb,oBAAC,MAAM,MAAG,cACV,6CACE,oBAAC,UAAU,EAAC,YAAY,CAAEA,iBAAkB,EAAG,CAC9CX,SAAS,eAAI,yBAAG,SAAS,CAAC,QAAQ,eAAe,CACjD,CAACA,SAAS,eAAI,oBAAC,WAAW,EAAC,KAAK,CAAEF,cAAe,EAAG,CAChD,CACQ,CAErB,CAEA,cAAeD,IAAG"},"metadata":{},"sourceType":"module","externalDependencies":[]}